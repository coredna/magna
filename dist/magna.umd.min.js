var magna=function(t){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function u(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function h(t,e,r){return(h=f()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return r&&l(o,r.prototype),o}).apply(null,arguments)}function p(t){var e="function"==typeof Map?new Map:void 0;return(p=function(t){if(null===t||(r=t,-1===Function.toString.call(r).indexOf("[native code]")))return t;var r;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return h(t,arguments,c(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),l(n,t)})(t)}function y(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function v(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?y(t):e}function g(t){return function(){var e,r=c(t);if(f()){var n=c(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return v(this,e)}}function d(t,e,r){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}})(t,e,r||t)}function m(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var s,u=t[Symbol.iterator]();!(n=(s=u.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return r}(t,e)||_(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(t){return function(t){if(Array.isArray(t))return q(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||_(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(t,e){if(t){if("string"==typeof t)return q(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?q(t,e):void 0}}function q(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function k(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=_(t))){var e=0,r=function(){};return{s:r,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,o,i=!0,s=!1;return{s(){n=t[Symbol.iterator]()},n(){var t=n.next();return i=t.done,t},e(t){s=!0,o=t},f(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function w(t,e){var r=e.get(t);if(!r)throw new TypeError("attempted to get private field on non-instance");return r.get?r.get.call(t):r.value}function S(t,e,r){var n=e.get(t);if(!n)throw new TypeError("attempted to set private field on non-instance");if(n.set)n.set.call(t,r);else{if(!n.writable)throw new TypeError("attempted to set read only private field");n.value=r}return r}function P(t,e,r){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return r}var O,E=Symbol("INITIALIZED"),j=Symbol("INIT_PROMISE"),x=Symbol("INIT_DONE"),A=Symbol("POPSTATE_PROMISE"),I=Symbol("POPSTATE_DONE"),T=function(t,e){var r;console.groupCollapsed("%c ".concat(t," "),"border-left:6px solid ".concat(e,";color:").concat(e));for(var n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];(r=console).log.apply(r,o),console.groupEnd()};function R(t,e){var r,n={};for(var o in e)!1!==Object.hasOwnProperty.call(e,o)&&(r=e[o],"[object Object]"===Object.prototype.toString.call(r)?n[o]=R(t[o],e[o]):n[o]=e[o]);for(var i in t)Object.hasOwnProperty.call(t,i)&&void 0===n[i]&&(n[i]=t[i]);return n}function C(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:" ";return e+r.repeat(t-e.length>0?t-e.length:0)}var N,D=new Map,F=new Map,L=(N=16e3,function(){return(N++).toString(16)}),U=function(t){a(n,t);var e=g(n);function n(){return r(this,n),e.apply(this,arguments)}return n}(p(Error)),M=function(t){a(n,t);var e=g(n);function n(){return r(this,n),e.apply(this,arguments)}return n}(p(Error));O=Symbol.toStringTag;var $=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];r(this,t),i(this,O,"Node"),this.constructor.defaultConfig?this.config=R(this.constructor.defaultConfig,e):this.constructor.config?this.config=R(this.constructor.config,e):this.config=e,this.nodes=n,this.id=L(),this[E]=!1,this[j]=Promise.resolve(null),this[x]=!1,this[A]=Promise.resolve(null),this[I]=!1,this.initChildren()}return o(t,[{key:"initChildren",value:function(){var t=this;this.nodes.forEach((function(e){e.parent=t}))}},{key:"init",value:function(t){t.request,t.response;return this.id}},{key:"destroy",value:function(t){t.request}},{key:"popstate",value:function(t){t.request,t.response;this.info("popstate")}},{key:"shouldInitialize",value:function(t){t.request;return!this.parent||this.parent[E]}},{key:"initPromise",value:function(t){t.request;return Promise.resolve("http: ".concat(this.id))}},{key:"getInitPromise",value:function(t){var e=t.request;if(this[E]=!1,this.shouldInitialize({request:e}))return this.info("init"),this[E]=!0,this.initPromise({request:e})}},{key:"popstatePromise",value:function(t){t.request;return Promise.resolve("popstate: ".concat(this.id))}},{key:"getPopstatePromise",value:function(t){var e=t.request;if(this[E]=!1,this.shouldInitialize({request:e}))return this[E]=!0,this.popstatePromise({request:e})}},{key:"getParentInitPromise",value:function(){return this.parent?this.parent[j]:Promise.resolve("root")}},{key:"getParentPopstatePromise",value:function(){return this.parent?this.parent[A]:Promise.resolve("root")}},{key:"runInit",value:function(t){var e=this,r=t.request;return this[j]=Promise.all([this.getParentInitPromise({request:r}),this.getInitPromise({request:r})]).then((function(t){var n=m(t,2),o=(n[0],n[1]);if(e[E])return Promise.resolve(e.init({request:r,response:o,config:e.config}))})).catch((function(t){return e.runCatch({request:r,error:t})})),this[x]=Promise.all([this[j]].concat(b(this.nodes.map((function(t){return t.runInit({request:r})}))))),this[x]}},{key:"runPopstate",value:function(t){var e=this,r=t.request;return this[A]=Promise.all([this.getParentPopstatePromise({request:r}),this.getPopstatePromise({request:r})]).then((function(t){var n=m(t,2),o=(n[0],n[1]);if(e[E])return Promise.resolve(e.popstate({request:r,response:o,popstateResult:o,config:e.config}))})).catch((function(t){return e.runCatch({request:r,error:t})})),this[I]=Promise.all([this[A]].concat(b(this.nodes.map((function(t){return t.runPopstate({request:r})}))))),this[I]}},{key:"runDestroy",value:function(t){var e=t.request;if(this[E]){this.info("destroy"),this[E]=!1;var r=this.nodes.map((function(t){return t.runDestroy({request:e})}));return Promise.all([this.destroy({request:e,config:this.config})].concat(b(r)))}return Promise.resolve()}},{key:"runCatch",value:function(t){var e=t.request,r=t.error;return this.catch({request:e,error:r})}},{key:"catch",value:function(t){var e=t.request,r=t.error;if(this[E]){switch(this[E]=!1,r.constructor){case U:!1!==this.onPropagateError({request:e,error:r})&&this.nodes.forEach((function(t){return t.catch({request:e,error:r,stack:r.stack})}));break;case M:!1!==this.onBubbleError({request:e,error:r})&&this.parent.catch({request:e,error:r,stack:r.stack});break;case Error:this.onCatch({request:e,error:r,stack:r.stack})}throw T("".concat(this.constructor.name,"::error"),"#e6194b",{self:this,error:r,stack:r.stack}),r}}},{key:"onCatch",value:function(t){var e=t.request,r=t.error;this.log("onCatch",{request:e,error:r})}},{key:"onPropagateError",value:function(t){t.request,t.error}},{key:"onBubbleError",value:function(t){t.request,t.error}},{key:"log",value:function(t,e){var r=this.constructor.plugin;!this.magna.debug||void 0!==r&&!0!==r.debug||(r=r||{debug:!0,color:"#777"},console.log("%c--\x3e ".concat(this[Symbol.toStringTag],"::").concat(t),"color: ".concat(r.color||"#000"),e,this))}},{key:"info",value:function(t){var e=this.constructor.plugin;if(this.magna.debug&&(void 0===e||!0===e.debug)){var r;e=e||{debug:!0,color:"#777"},console.groupCollapsed("%c%s %c%s","color:#aaa",C(10,this[Symbol.toStringTag]),"color: ".concat(e.color),"".concat(this[Symbol.toStringTag]||this.constructor.name,"::").concat(t));for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];(r=console).log.apply(r,[this].concat(o)),console.groupEnd()}}},{key:"setState",value:function(t,e){return this.magna.setState(t,e),this.magna.getState(t)}},{key:"subscribe",value:function(t,e){return this.magna.subscribe(this,t,e),!0}},{key:"unsubscribe",value:function(t,e){return this.magna.unsubscribe(this,t,e),!0}},{key:"loaderStart",value:function(){}},{key:"loaderStop",value:function(){}},{key:"parent",get:function(){return D.get(this)},set:function(t){return D.set(this,t)}},{key:"magna",get:function(){return F.has(this)?F.get(this):F.set(this,function t(e){return e.parent?t(e.parent):e}(this)),F.get(this)}}]),t}();function z(t){const e=Array.isArray(t)?Array(t.length):{};if(t&&t.getTime)return new Date(t.getTime());for(const r in t){const n=t[r];e[r]="object"==typeof n&&null!==n?n.getTime?new Date(n.getTime()):z(n):n}return e}function B(t){const e=typeof t;if(null===t)return"Null";if(void 0===t)return"Undefined";if("boolean"===e)return"Boolean";if("number"===e)return Number.isNaN(t)?"NaN":"Number";if("string"===e)return"String";if(Array.isArray(t))return"Array";if(t instanceof RegExp)return"RegExp";const r=t&&t.toString?t.toString():"";return["true","false"].includes(r)?"Boolean":Number.isNaN(Number(r))?r.startsWith("async")?"Async":"[object Promise]"===r?"Promise":"function"===e?"Function":t instanceof String?"String":"Object":"Number"}function W(t){const e=t.__proto__.toString();return["Error","TypeError"].includes(e)?[e,t.message]:[]}function H(t){return t.toDateString?[!0,t.getTime()]:[!1]}function Z(t){return t.constructor!==RegExp?[!1]:[!0,t.toString()]}function G(t,e){if(1===arguments.length)return e=>G(t,e);const r=B(t);if(r!==B(e))return!1;if(["NaN","Undefined","Null"].includes(r))return!0;if(["Boolean","Number","String"].includes(r))return t.toString()===e.toString();if("Array"===r){const r=Array.from(t),n=Array.from(e);if(r.toString()!==n.toString())return!1;let o=!0;return r.forEach((t,e)=>{o&&(t===n[e]||G(t,n[e])||(o=!1))}),o}const n=Z(t),o=Z(e);if(n[0])return!!o[0]&&n[1]===o[1];if(o[0])return!1;const i=H(t),s=H(e);if(i[0])return!!s[0]&&i[1]===s[1];if(s[0])return!1;const u=W(t),a=W(e);if(u[0])return!!a[0]&&(u[0]===a[0]&&u[1]===a[1]);if("Object"===r){const r=Object.keys(t);if(r.length!==Object.keys(e).length)return!1;let n=!0;return r.forEach(r=>{if(n){const o=t[r],i=e[r];o===i||G(o,i)||(n=!1)}}),n}return!1}function Q(t,e=[]){return(...r)=>{return(n=[...e,...r]).length>=t.length?t(...n):Q(t,n);var n}}const J=Q((function(t,e,r){return Object.assign({},r,{[t]:e})}));function K(t){return t<<0===t}const V=Q((function t(e,r,n){const o="string"==typeof e?e.split("."):e;if(0===o.length)return r;const i=o[0];if(o.length>1){const e="object"!=typeof n||null===n||!n.hasOwnProperty(i)?K(parseInt(o[1],10))?[]:{}:n[i];r=t(Array.prototype.slice.call(o,1),r,e)}if(K(parseInt(i,10))&&Array.isArray(n)){const t=n.slice();return t[i]=r,t}return J(i,r,n)}));function X(t){return function t(e,r){return 1===arguments.length?r=>t(e,r):function(t){return function(n){return t(e(n)).map(t=>r(t,n))}}}(function t(e,r){if(1===arguments.length)return r=>t(e,r);if(null==r)return;let n=r,o=0;const i="string"==typeof e?e.split("."):e;for(;o<i.length;){if(null==n)return;n=n[i[o]],o++}return n}(t),V(t))}const Y=t=>({x:t,map:e=>Y(e(t))});function tt(t,e,r){return 1===arguments.length?(e,r)=>tt(t,e,r):2===arguments.length?r=>tt(t,e,r):t(t=>Y(e(t)))(r).x}const et=t=>({x:t,map:e=>et(t)});function rt(t,e){return 1===arguments.length?e=>rt(t,e):t(et)(e).x}var nt=function t(e){r(this,t),Object.setPrototypeOf(this,new Proxy(e,t.handler))};i(nt,"handler",{get:function(t,r,n){return"function"==typeof t[r]?function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return t[r].apply(t,n)}:"object"===e(t[r])&&void 0!==t[r]?new nt(t[r],nt.handler):t.get(r)},set:function(t,e,r){return t.set(e,r)}});var ot=function(){function t(e){return r(this,t),it.add(this),i(this,"__subscribers",new Map),i(this,"__state",{}),this.__state=e,new nt(this)}return o(t,[{key:"get",value:function(t){return this.__state[t]}},{key:"unsafeReplaceState",value:function(t){var e=this.__state;return this.__state=t,P(this,it,st).call(this,e,this.__state),t}},{key:"set",value:function(t,e){return this.setState(t,(r=e,()=>r));var r}},{key:"setState",value:function(t,e){t=Array.isArray(t)?t.join("."):t;var r=this.__state,n=X(t);return this.__state=tt(n,e,this.__state),P(this,it,st).call(this,r,this.__state),rt(n,this.__state)}},{key:"subscribe",value:function(t,e){t=Array.isArray(t)?t.join("."):t,this.__subscribers.has(t)||this.__subscribers.set(t,new Set([])),this.__subscribers.get(t).add(e)}},{key:"unsubscribe",value:function(t,e){t=Array.isArray(t)?t.join("."):t,this.__subscribers.has(prop)&&this.__subscribers.get(prop).delete(e)}},{key:"trigger",value:function(t){var e=this;t?b(this.__subscribers.entries()).filter((function(t){var e,r=m(t,2),n=r[0];r[1];return new RegExp("^"+(e=n,e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")),"gmi").test(n)})).forEach((function(t){var r=m(t,2),n=r[0],o=r[1],i=rt(X(n),e.__state),s=z(e.__state);o(i,i,s,s)})):P(this,it,st).call(this,{},this.__state)}},{key:"getState",value:function(){return z(this.__state)}},{key:"getSubscribers",value:function(){return new Map(b(this.__subscribers.entries()).map((function(t){var e=m(t,2),r=e[0],n=e[1];return[r,new Set(n)]})))}},{key:"unsafeGetState",value:function(){return this.__state}},{key:"unsafeGetSubscribers",value:function(){return this.__subscribers}},{key:"destroy",value:function(){this.__subscribers=new Map,this.__state={}}}]),t}(),it=new WeakSet,st=function(t,e){var r,n=k(this.__subscribers);try{var o=function(){var n=m(r.value,2),o=n[0],i=n[1],s=X(o),u=rt(s,t),a=rt(s,e);G(u,a)||i.forEach((function(r){3===r.length?r(a,u,z(e)):4===r.length?r(a,u,z(e),z(t)):r(a,u)}))};for(n.s();!(r=n.n()).done;)o()}catch(t){n.e(t)}finally{n.f()}};var ut=new RegExp("%[a-f0-9]{2}","gi"),at=new RegExp("(%[a-f0-9]{2})+","gi");function ct(t,e){try{return decodeURIComponent(t.join(""))}catch(t){}if(1===t.length)return t;e=e||1;var r=t.slice(0,e),n=t.slice(e);return Array.prototype.concat.call([],ct(r),ct(n))}function lt(t){try{return decodeURIComponent(t)}catch(n){for(var e=t.match(ut),r=1;r<e.length;r++)e=(t=ct(e,r).join("")).match(ut);return t}}var ft,ht=function(t){if("string"!=typeof t)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch(e){return function(t){for(var e={"%FE%FF":"��","%FF%FE":"��"},r=at.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch(t){var n=lt(r[0]);n!==r[0]&&(e[r[0]]=n)}r=at.exec(t)}e["%C2"]="�";for(var o=Object.keys(e),i=0;i<o.length;i++){var s=o[i];t=t.replace(new RegExp(s,"g"),e[s])}return t}(t)}},pt=(t,e)=>{if("string"!=typeof t||"string"!=typeof e)throw new TypeError("Expected the arguments to be of type `string`");if(""===e)return[t];const r=t.indexOf(e);return-1===r?[t]:[t.slice(0,r),t.slice(r+e.length)]},yt=(function(t,e){function r(t){if("string"!=typeof t||1!==t.length)throw new TypeError("arrayFormatSeparator must be single character string")}function n(t,e){return e.encode?e.strict?encodeURIComponent(t).replace(/[!'()*]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`):encodeURIComponent(t):t}function o(t,e){return e.decode?ht(t):t}function i(t){const e=t.indexOf("#");return-1!==e&&(t=t.slice(0,e)),t}function s(t){const e=(t=i(t)).indexOf("?");return-1===e?"":t.slice(e+1)}function u(t,e){return e.parseNumbers&&!Number.isNaN(Number(t))&&"string"==typeof t&&""!==t.trim()?t=Number(t):!e.parseBooleans||null===t||"true"!==t.toLowerCase()&&"false"!==t.toLowerCase()||(t="true"===t.toLowerCase()),t}function a(t,e){r((e=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},e)).arrayFormatSeparator);const n=function(t){let e;switch(t.arrayFormat){case"index":return(t,r,n)=>{e=/\[(\d*)\]$/.exec(t),t=t.replace(/\[\d*\]$/,""),e?(void 0===n[t]&&(n[t]={}),n[t][e[1]]=r):n[t]=r};case"bracket":return(t,r,n)=>{e=/(\[\])$/.exec(t),t=t.replace(/\[\]$/,""),e?void 0!==n[t]?n[t]=[].concat(n[t],r):n[t]=[r]:n[t]=r};case"comma":case"separator":return(e,r,n)=>{const i="string"==typeof r&&r.split("").indexOf(t.arrayFormatSeparator)>-1?r.split(t.arrayFormatSeparator).map(e=>o(e,t)):null===r?r:o(r,t);n[e]=i};default:return(t,e,r)=>{void 0!==r[t]?r[t]=[].concat(r[t],e):r[t]=e}}}(e),i=Object.create(null);if("string"!=typeof t)return i;if(!(t=t.trim().replace(/^[?#&]/,"")))return i;for(const r of t.split("&")){let[t,s]=pt(e.decode?r.replace(/\+/g," "):r,"=");s=void 0===s?null:"comma"===e.arrayFormat?s:o(s,e),n(o(t,e),s,i)}for(const t of Object.keys(i)){const r=i[t];if("object"==typeof r&&null!==r)for(const t of Object.keys(r))r[t]=u(r[t],e);else i[t]=u(r,e)}return!1===e.sort?i:(!0===e.sort?Object.keys(i).sort():Object.keys(i).sort(e.sort)).reduce((t,e)=>{const r=i[e];return Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?t[e]=function t(e){return Array.isArray(e)?e.sort():"object"==typeof e?t(Object.keys(e)).sort((t,e)=>Number(t)-Number(e)).map(t=>e[t]):e}(r):t[e]=r,t},Object.create(null))}e.extract=s,e.parse=a,e.stringify=(t,e)=>{if(!t)return"";r((e=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},e)).arrayFormatSeparator);const o=function(t){switch(t.arrayFormat){case"index":return e=>(r,o)=>{const i=r.length;return void 0===o||t.skipNull&&null===o?r:null===o?[...r,[n(e,t),"[",i,"]"].join("")]:[...r,[n(e,t),"[",n(i,t),"]=",n(o,t)].join("")]};case"bracket":return e=>(r,o)=>void 0===o||t.skipNull&&null===o?r:null===o?[...r,[n(e,t),"[]"].join("")]:[...r,[n(e,t),"[]=",n(o,t)].join("")];case"comma":case"separator":return e=>(r,o)=>null==o||0===o.length?r:0===r.length?[[n(e,t),"=",n(o,t)].join("")]:[[r,n(o,t)].join(t.arrayFormatSeparator)];default:return e=>(r,o)=>void 0===o||t.skipNull&&null===o?r:null===o?[...r,n(e,t)]:[...r,[n(e,t),"=",n(o,t)].join("")]}}(e),i=Object.assign({},t);if(e.skipNull)for(const t of Object.keys(i))void 0!==i[t]&&null!==i[t]||delete i[t];const s=Object.keys(i);return!1!==e.sort&&s.sort(e.sort),s.map(r=>{const i=t[r];return void 0===i?"":null===i?n(r,e):Array.isArray(i)?i.reduce(o(r),[]).join("&"):n(r,e)+"="+n(i,e)}).filter(t=>t.length>0).join("&")},e.parseUrl=(t,e)=>({url:i(t).split("?")[0]||"",query:a(s(t),e)}),e.stringifyUrl=(t,r)=>{const n=i(t.url).split("?")[0]||"",o=e.extract(t.url),s=e.parse(o),u=function(t){let e="";const r=t.indexOf("#");return-1!==r&&(e=t.slice(r)),e}(t.url),a=Object.assign(s,t.query);let c=e.stringify(a,r);return c&&(c=`?${c}`),`${n}${c}${u}`}}(ft={exports:{}},ft.exports),ft.exports);yt.extract,yt.parse,yt.stringify,yt.parseUrl,yt.stringifyUrl;function vt(t,e){var r=e.magna;r.debug&&("development"===r.env?console.group("%c%s %c%s %c%s %c%s","color:#aaa","route","color:purple",t,"color:#111",location.pathname,"color:#007bff;font-weight:normal",r.request.type):"staging"===r.env&&console.groupCollapsed("%c%s %c%s %c%s %c%s","color:#aaa","route","color:purple",t,"color:#111",location.pathname,"color:#007bff;font-weight:normal",r.request.type))}function gt(t){var e=[],r={},n=!(t instanceof RegExp)&&t.replace(/\//g,"\\/").replace(/\.?\*/,".*").replace(/\{([^:]+)\:?([^}]*)(\?)?\}/g,(function(t,n,o,i){switch(e.push(n),r[n]={type:o},o){case"char":case"alpha":case"string":return r[n].regex="([a-zA-Z-_%&]".concat(i?"*":"+",")");case"int":case"num":case"number":return r[n].regex="([0-9]".concat(i?"*":"+",")");default:return o?(r[n].type="regex",r[n].regex=o):(r[n].type="mixed",r[n].regex="([a-zA-Z0-9-_%&]".concat(i?"*":"+",")"))}}));return{params:r,string:n,index:e,regex:t instanceof RegExp?t:new RegExp(n)}}var dt,mt,bt=null,_t=(dt=0,function(){return dt++}),qt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.type,o=void 0===n?"http":n,s=e.uuid,u=void 0===s?_t():s,a=e.href,c=void 0===a?location.href:a,l=e.query,f=void 0===l?{}:l,h=e.scrollTop,p=void 0===h?0:h,y=e.title,v=void 0===y?document.title:y;r(this,t),i(this,"type","http"),i(this,"keywords",[]),i(this,"params",{}),i(this,"values",[]),i(this,"scrollTop",0),i(this,"query",{}),this.prev=bt,this.type=o,this.uuid=u,~c.indexOf("http")&&location.origin&&(c=c.replace(location.origin,""));var g=c.indexOf("?"),d=g>-1?yt.parse(c.slice(g+1)):{};this.query=R(d,f),this.search=yt.stringify(this.query,{encode:!1,arrayFormat:"brackets"}),this.pathname=location.pathname,this.href=this.pathname+(this.search?"?".concat(this.search):""),this.title=v,this.scrollTop=p,bt=this.pathname}return o(t,[{key:"combineParams",value:function(t){var e=t.params;return this.params=R(this.params,e),this}}]),t}();mt=Symbol.toStringTag;var kt,wt=function(t){a(n,t);var e=g(n);function n(t){var o;return r(this,n),i(y(o=e.call(this,{},t)),"debug",!0),i(y(o),"env","development"),i(y(o),"setScrollOnPopstate",!0),i(y(o),mt,"Magna"),o.__state={},o.__subscribers=new Map,o[E]=!1,o.__setActiveUrl(),window.addEventListener("popstate",(function(t){if(null===t.state)return t.preventDefault(),!1;var e=o.request=new qt(t.state);return o.__setActiveUrl(),vt("popstate",y(o)),o.runDestroy({request:e}).then((function(t){return console.groupEnd(),vt("popstate",y(o)),o.runPopstate({request:e}).then((function(t){return console.groupEnd(),t})).then((function(t){return vt("init",y(o)),t})).then((function(t){return o.runInit({request:e})})).then((function(t){return console.groupEnd(),t})).then((function(t){return window.dataLayer&&window.dataLayer.push({event:"Pageview",url:location.href}),t}))}))})),o}return o(n,[{key:"initChildren",value:function(){var t=this;this.nodes.forEach((function(e){e.parent=t}))}},{key:"start",value:function(t){var e=t.debug,r=void 0!==e&&e,n=t.env,o=void 0===n?"development":n,i=t.setScrollOnPopstate,s=void 0===i||i,a=t.request,c=void 0===a?null:a;return this.debug=r,this.env=o,this.setScrollOnPopstate=s,this[E]=!0,this.request=null!=c?c:new qt,history.replaceState(u({},history.state,{scrollTop:document.body.scrollTop},this.request),document.title),vt("start",this),this.initChildren(),this.runInit({request:this.request}).then((function(t){return console.groupEnd(),t})),this}},{key:"popstate",value:function(t){t.request;var e=t.response;return this.debug&&console.log("popstate",e),window.dataLayer&&window.dataLayer.push({event:"Pageview",url:location.href}),this.debug&&console.groupEnd(),Promise.resolve()}},{key:"pushState",value:function(t,e,r,n){return this.request=new qt({type:"popstate",href:r,params:n,title:e}),this.pushStateWithRequest(this.request)}},{key:"pushStateWithRequest",value:function(t){var e=this;return history.replaceState(u({},history.state,{scrollTop:document.body.scrollTop}),document.title),history.pushState(t,t.title,t.href),this.__setActiveUrl(),vt("pushState",this),this.runDestroy({request:t}).then((function(t){return console.groupEnd(),vt("popstate",e),e.runPopstate({request:e.request}).then((function(t){return console.groupEnd(),t})).then((function(t){return vt("init",e),t})).then((function(t){return e.runInit({request:e.request})})).then((function(t){return console.groupEnd(),t})).then((function(t){return window.dataLayer&&window.dataLayer.push({event:"Pageview",url:location.href}),t}))}))}},{key:"use",value:function(t){return this.nodes=[].concat(b(this.nodes),b(t)),this.initChildren(),this}},{key:"rerun",value:function(){var t=this;return this.destroy(this.request).then((function(e){t.request=new qt(u({type:"manual"},t.request)),t.init(t.request)})),this}},{key:"__setActiveUrl",value:function(){var t=location.pathname.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");document.querySelectorAll(".link--active").forEach((function(t){return t.classList.remove("link--active")})),b(document.querySelectorAll("a[href]")).filter((function(e){var r=e.href.replace(location.origin,"");return new RegExp("^"+t+"$").test(r)})).forEach((function(t){return t.classList.add("link--active")}))}},{key:"getState",value:function(t){return u({},this.__state)}},{key:"setState",value:function(t,e){"string"==typeof t&&(t=t.split(".")),t=t||["global"];var r=this.__state,n=tt(X(t),e,this.__state);if(n===this.__state)throw new Error("Do not mutate the state, please return a new object for the state");this.__state=n;var o,i=k(this.__subscribers);try{var s=function(){var t=m(o.value,2),e=t[0],i=t[1],s=X(e.split("."));G(rt(s,r),rt(s,n))||i.forEach((function(t){var e=t.instance,r=t.cb;e[E]&&tt(s,r,n)}))};for(i.s();!(o=i.n()).done;)s()}catch(t){i.e(t)}finally{i.f()}return this}},{key:"subscribe",value:function(t,e,r){e=e?Array.isArray(e)?e.join("."):e:"global";var n=[];this.__subscribers.has(e)&&(n=this.__subscribers.get(e)),n.some((function(e){return e.cb===r&&e.instance===t}))||n.push({instance:t,cb:r,state:{}}),this.__subscribers.set(e,n)}},{key:"unsubscribe",value:function(t,e,r){e=Array.isArray(e)?e.join("."):String(e);var n=this.__subscribers.get(e).filter((function(e){return e.instance!==t&&e.cb!==r}));return this.__subscribers.set(e,n),!0}},{key:"trigger",value:function(t){var e=this;this.__subscribers.has(t)&&this.__subscribers.get(t).forEach((function(r){var n=r.cb,o=r.instance;o[E]&&(n(e.getState()),window.dispatchEvent(new CustomEvent(t,{detail:{state:rt(X(t),e.getState()),instance:o}})))}))}}]),n}($);kt=Symbol.toStringTag;var St,Pt=function(t){a(n,t);var e=g(n);function n(t){var o;r(this,n),i(y(o=e.call(this,t)),kt,"ExtendablePlugin"),i(y(o),"getters",[]);for(var s=function(){var t=a[u];Object.defineProperty(y(o),t,{get:function(){return o.config[t]},set:function(e){return o.config[t]=e}})},u=0,a=Object.keys(o.config);u<a.length;u++)s();var c,l=k(o.getters);try{for(l.s();!(c=l.n()).done;)key=c.value,Object.defineProperty(y(o),key,{get:function(){return o.config[key]},set:function(t){return o.config[key]=t}})}catch(t){l.e(t)}finally{l.f()}return o}return o(n,[{key:"init",value:function(t){return t.request.url}}]),n}($);St=Symbol.toStringTag;var Ot,Et=function(t){a(n,t);var e=g(n);function n(t){var o,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return r(this,n),i(y(o=e.call(this,{},s)),St,"Import"),o.__promise=null,o.importer=t,o}return o(n,[{key:"initChildren",value:function(){var t=this;this.nodes.forEach((function(e){return e.parent=t}))}},{key:"initPromise",value:function(t){var e=t.request;return this.__promise=this.__promise||this.importer({request:e})}},{key:"popstatePromise",value:function(t){var e=t.request;return this.__promise=this.__promise||this.importer({request:e})}},{key:"runInit",value:function(t){var e=this,r=t.request;return d(c(n.prototype),"runInit",this).call(this,{request:r}).then((function(t){return e[E]&&e.__promise&&e.__promise.then((function(t){return t.default.parent=e,t.default.runInit({request:r})}))}))}},{key:"runPopstate",value:function(t){var e=this,r=t.request;return d(c(n.prototype),"runPopstate",this).call(this,{request:r}).then((function(t){return e[E]&&e.__promise&&e.__promise.then((function(t){return t.default.runPopstate({request:r})}))}))}},{key:"runDestroy",value:function(t){var e=this,r=t.request;return d(c(n.prototype),"runDestroy",this).call(this,{request:r}).then((function(t){return e.__promise&&e.__promise.then((function(t){return t.default.runDestroy({request:r})}))}))}},{key:"init",value:function(t){t.request;return this.url}}]),n}($);Ot=Symbol.toStringTag;var jt,xt=function(t){a(n,t);var e=g(n);function n(t,o){var s,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return r(this,n),i(y(s=e.call(this,o,u)),Ot,"Lazy"),s.__promise=null,s.importer=t,s.instance=null,s}return o(n,[{key:"initChildren",value:function(){}},{key:"initPromise",value:function(t){var e=t.request;return this.__promise=this.__promise||this.importer({request:e})}},{key:"popstatePromise",value:function(t){var e=t.request;return this.__promise=this.__promise||this.importer({request:e})}},{key:"runInit",value:function(t){var e=this,r=t.request;return d(c(n.prototype),"runInit",this).call(this,{request:r}).then((function(t){return e[E]&&e.__promise&&e.__promise.then((function(t){return e.instance=new t.default(e.config),e.instance.runInit({request:r}),e.instance}))}))}},{key:"runPopstate",value:function(t){var e=this,r=t.request;return d(c(n.prototype),"runPopstate",this).call(this,{request:r}).then((function(t){return e[E]&&e.__promise&&e.__promise.then((function(t){return e.instance.runPopstate({request:r})}))}))}},{key:"runDestroy",value:function(t){var e=this,r=t.request;return d(c(n.prototype),"runDestroy",this).call(this,{request:r}).then((function(t){return e.__promise&&e.__promise.then((function(t){return e.instance.runDestroy({request:r})}))}))}},{key:"init",value:function(t){t.request;return this.url}}]),n}($);jt=Symbol.toStringTag;var At,It=function(t){a(n,t);var e=g(n);function n(t){var o;return r(this,n),i(y(o=e.call(this,{},t)),jt,"Module"),o}return o(n,[{key:"init",value:function(t){return t.request.url}}]),n}($);At=Symbol.toStringTag;var Tt,Rt=function(t){a(n,t);var e=g(n);function n(t){var o;return r(this,n),i(y(o=e.call(this,t)),At,"Plugin"),o}return o(n,[{key:"init",value:function(t){return t.request.url}}]),n}($);Tt=Symbol.toStringTag;var Ct,Nt=function(t){a(n,t);var e=g(n);function n(){var t;r(this,n);for(var o=arguments.length,s=new Array(o),u=0;u<o;u++)s[u]=arguments[u];return i(y(t=e.call.apply(e,[this].concat(s))),Tt,"Predicate"),t}return o(n,[{key:"shouldInitialize",value:function(t){var e=t.request;return!this.parent||this.parent[E]&&this.predicate({request:e})}},{key:"predicate",value:function(t){t.request;throw new Error("Predicate class must contain a predicate method that returns a boolean")}}]),n}($);Ct=Symbol.toStringTag;var Dt,Ft=function(t){a(n,t);var e=g(n);function n(t){var o,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return r(this,n),i(y(o=e.call(this,{url:t},s)),Ct,"Route"),o}return o(n,[{key:"predicate",value:function(t){var e=t.request;return this.parser.regex.test(e.pathname)}},{key:"processHref",value:function(t){var e=t.href,r=t.regex,n=(t.params,t.keywords,t.index),o=e.match(r);return o?n.reduce((function(t,e,r){return u({},t,i({},e,o[r+1]))}),{}):{}}},{key:"createNewRequest",value:function(t){var e=t.request,r=gt(this.config.url),n=this.processHref(u({href:e.pathname},r)),o=yt.parse(location.search.slice(1),{plainObjects:!0});return this.parser=r,this.params=n,this.search=o,e.params=R(e.params,n),u({},e,{params:u({},e.params&&e.params,{},n),search:o})}},{key:"decorateRequest",value:function(t){var e=t.request;return this.parser=gt(this.config.url),this.params=this.processHref(u({href:e.pathname},this.parser)),e.combineParams({params:this.params}),e}},{key:"runInit",value:function(t){var e=t.request;return d(c(n.prototype),"runInit",this).call(this,{request:this.decorateRequest({request:e})})}},{key:"runPopstate",value:function(t){var e=t.request;return d(c(n.prototype),"runPopstate",this).call(this,{request:this.decorateRequest({request:e})})}},{key:"info",value:function(t){var e=this.constructor.plugin;if(this.magna.debug&&(void 0===e||!0===e.debug)){var r;e=e||{debug:!0,color:"#777"},console.groupCollapsed("%c%s %c%s","color:#aaa",C(10,this[Symbol.toStringTag]),"color: ".concat(e.color),"".concat(this.constructor.name,"::").concat(t),this.config.url);for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];(r=console).log.apply(r,[this].concat(o)),console.groupEnd()}}}]),n}(Nt);i(Ft,"plugin",{color:"#A82DFF",debug:!0}),Dt=Symbol.toStringTag;var Lt,Ut=function(t){a(n,t);var e=g(n);function n(t){var o;return r(this,n),i(y(o=e.call(this,t)),Dt,"Singleton"),i(y(o),"initialized",!1),o}return o(n,[{key:"shouldInitialize",value:function(t){t.request;return!this.initialized&&(this.initialized=!0)}},{key:"init",value:function(t){return t.request.url}}]),n}($);Lt=Symbol.toStringTag;var Mt=function(t){a(n,t);var e=g(n);function n(t,o){var s;return r(this,n),i(y(s=e.call(this,{selector:t},o)),Lt,"ElementExists"),s}return o(n,[{key:"predicate",value:function(t){t.request;return!!document.querySelector(this.config.selector)}}]),n}(Nt),$t=function(t){a(n,t);var e=g(n);function n(t,o,i){var s;return r(this,n),s=e.call(this,{event:t,target:o},i),zt.set(y(s),{writable:!0,value:null}),Bt.set(y(s),{writable:!0,value:null}),s}return o(n,[{key:"runInit",value:function(t){var e=this,r=t.request;this[E]=!0,S(this,zt,document.querySelector(this.config.target)),w(this,zt).addEventListener(this.config.event,S(this,Bt,(function(t){w(e,zt).removeEventListener(e.config.event,w(e,Bt)),d(c(n.prototype),"runInit",e).call(e,{request:r})})))}},{key:"runDestroy",value:function(t){var e=t.request;return w(this,zt).removeEventListener(this.config.event,w(this,Bt)),d(c(n.prototype),"runDestroy",this).call(this,{request:e})}}]),n}($),zt=new WeakMap,Bt=new WeakMap,Wt=function(t){a(n,t);var e=g(n);function n(t,o){var i;return r(this,n),(i=e.call(this,t,o)).nodes=o,i.pattern=t,i.regex=regexify(t),i}return o(n,[{key:"initNodes",value:function(t){var e=t.request;return this.regex.test(e.prev)!==this.regex.test(e.pathname)?d(c(n.prototype),"initNodes",this).call(this,{request:e}):Promise.resolve("OnlyOnRouteChange:same-url")}},{key:"initDestroy",value:function(t){var e=t.request;return this.regex.test(e.prev)!==this.regex.test(e.pathname)?d(c(n.prototype),"initDestroy",this).call(this,{request:e}):Promise.resolve("OnlyOnRouteChange:same-url")}}]),n}($),Ht=function(t){a(n,t);var e=g(n);function n(t,o){return r(this,n),e.call(this,{event:t},o)}return o(n,[{key:"runInit",value:function(t){var e=this,r=t.request;this[E]=!0,this.subscribe(this.config.event,this.__onEvent=function(t){e.unsubscribe(e.config.event,e.__onEvent),d(c(n.prototype),"runInit",e).call(e,{request:r})})}},{key:"runDestroy",value:function(t){var e=t.request;this.unsubscribe(this.config.event,this.__onEvent),d(c(n.prototype),"runDestroy",this).call(this,{request:e})}}]),n}($);return console.log("test!!!!!!"),t.ElementExists=Mt,t.ExtendablePlugin=Pt,t.Import=Et,t.Lazy=xt,t.Magna=wt,t.Module=It,t.Node=$,t.One=$t,t.OnlyOnRouteChange=Wt,t.Plugin=Rt,t.Predicate=Nt,t.Route=Ft,t.Singleton=Ut,t.State=ot,t.Subscribe=Ht,t.combineUrlParams=function(t,e){var r=t.indexOf("?");if(r>-1){var n=t.slice(0,r),o=yt.parse(t.slice(r)),i=yt.stringify(u({},o,{},e),{encode:!1,arrayFormat:"brackets"});return console.log({urlSlug:n,urlParams:o,newQueryParams:i}),n+(i.length?"?"+i:"")}return void 0!==e&&Object.getOwnPropertyNames(e).length?t+"?"+yt.stringify(e,{encode:!1,arrayFormat:"brackets"}):t},t.debounce=function(t,e){var r=null;return function(n){var o=this,i=arguments;clearTimeout(r),r=setTimeout((function(){e.apply(o,i)}),t)}},t.default=wt,t.elementExists=function(t,e){return new Mt(t,e)},t.log=T,t.logAction=function(t,e){var r=e.magna;r.debug&&("development"===r.env?console.group("%c%s %c%s","color:#aaa","action","color:teal",t):"staging"===r.env&&console.groupCollapsed("%c%s %c%s","color:#aaa","action","color:teal",t))},t.logRoute=vt,t.mergeDeepRight=R,t.one=function(t,e,r){return new $t(t,e,r)},t.onlyOnRouteChange=function(t,e){return new Wt(t,e)},t.pad=C,t.prettify=function(t){return t.replace("%20"," ").replace(/([^a-z0-9]+)/gim," ")},t.radioClass=function(t,e){return function(r){e=document.querySelector(e),t.forEach((function(t){return e.classList.remove(t)})),e.classList.add(r)}},t.regexify=gt,t.route=function(t,e){return new Ft(t,e)},t.subscribe=function(t,e,r){return new Ht(t,e,r)},t.tap=function(t){return function(e){return t.call(this,e),e}},t.trace=function(t){return function(e){return console.log(t,e),e}},t.uglify=function(t){return t.toLowerCase().replace(/([^a-z0-9]+)/gim,"-")},t}({});
