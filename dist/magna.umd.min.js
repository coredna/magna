var magna=function(t){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function n(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function i(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function u(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach((function(e){o(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function f(t,e,r){return(f=l()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return r&&c(o,r.prototype),o}).apply(null,arguments)}function h(t){var e="function"==typeof Map?new Map:void 0;return(h=function(t){if(null===t||(r=t,-1===Function.toString.call(r).indexOf("[native code]")))return t;var r;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return f(t,arguments,a(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),c(n,t)})(t)}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function y(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?p(t):e}function v(t){return function(){var e,r=a(t);if(l()){var n=a(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return y(this,e)}}function g(t,e,r){return(g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=a(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}})(t,e,r||t)}function d(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var u,s=t[Symbol.iterator]();!(n=(u=s.next()).done)&&(r.push(u.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}(t,e)||b(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t){return function(t){if(Array.isArray(t))return q(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||b(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(t,e){if(t){if("string"==typeof t)return q(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?q(t,e):void 0}}function q(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function w(t,e){var r=e.get(t);if(!r)throw new TypeError("attempted to get private field on non-instance");return r.get?r.get.call(t):r.value}function k(t,e,r){var n=e.get(t);if(!n)throw new TypeError("attempted to set private field on non-instance");if(n.set)n.set.call(t,r);else{if(!n.writable)throw new TypeError("attempted to set read only private field");n.value=r}return r}var _,S=Symbol("INITIALIZED"),P=Symbol("INIT_PROMISE"),O=Symbol("INIT_DONE"),E=Symbol("POPSTATE_PROMISE"),j=Symbol("POPSTATE_DONE"),x=function(t,e){var r;console.groupCollapsed("%c ".concat(t," "),"border-left:6px solid ".concat(e,";color:").concat(e));for(var n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];(r=console).log.apply(r,o),console.groupEnd()};function I(t,e){var r,n={};for(var o in e)!1!==Object.hasOwnProperty.call(e,o)&&(r=e[o],"[object Object]"===Object.prototype.toString.call(r)?n[o]=I(t[o],e[o]):n[o]=e[o]);for(var i in t)Object.hasOwnProperty.call(t,i)&&void 0===n[i]&&(n[i]=t[i]);return n}function A(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:" ";return e+r.repeat(t-e.length>0?t-e.length:0)}var N,T=new Map,R=(N=16e3,function(){return(N++).toString(16)}),C=function(t){s(n,t);var r=v(n);function n(){return e(this,n),r.apply(this,arguments)}return n}(h(Error)),D=function(t){s(n,t);var r=v(n);function n(){return e(this,n),r.apply(this,arguments)}return n}(h(Error));_=Symbol.toStringTag;var F=function(){function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];e(this,t),o(this,_,"Node"),this.constructor.defaultConfig?this.config=I(this.constructor.defaultConfig,r):this.constructor.config?this.config=I(this.constructor.config,r):this.config=r,this.nodes=n,this.id=R(),this[S]=!1,this[P]=Promise.resolve(null),this[O]=!1,this[E]=Promise.resolve(null),this[j]=!1,this.initChildren()}return n(t,[{key:"initChildren",value:function(){var t=this;this.nodes.forEach((function(e){return e.parent=t}))}},{key:"init",value:function(t){t.request,t.response;return this.id}},{key:"destroy",value:function(t){t.request}},{key:"popstate",value:function(t){t.request,t.response;this.info("popstate")}},{key:"shouldInitialize",value:function(t){t.request;return!this.parent||this.parent[S]}},{key:"initPromise",value:function(t){t.request;return Promise.resolve("http: ".concat(this.id))}},{key:"getInitPromise",value:function(t){var e=t.request;if(this[S]=!1,this.shouldInitialize({request:e}))return this.info("init"),this[S]=!0,this.initPromise({request:e})}},{key:"popstatePromise",value:function(t){t.request;return Promise.resolve("popstate: ".concat(this.id))}},{key:"getPopstatePromise",value:function(t){var e=t.request;if(this[S]=!1,this.shouldInitialize({request:e}))return this[S]=!0,this.popstatePromise({request:e})}},{key:"getParentInitPromise",value:function(){return this.parent?this.parent[P]:Promise.resolve("root")}},{key:"getParentPopstatePromise",value:function(){return this.parent?this.parent[E]:Promise.resolve("root")}},{key:"runInit",value:function(t){var e=this,r=t.request;return this[P]=Promise.all([this.getParentInitPromise({request:r}),this.getInitPromise({request:r})]).then((function(t){var n=d(t,2),o=(n[0],n[1]);if(e[S])return Promise.resolve(e.init({request:r,response:o,config:e.config}))})).catch((function(t){return e.runCatch({request:r,error:t})})),this[O]=Promise.all([this[P]].concat(m(this.nodes.map((function(t){return t.runInit({request:r})}))))),this[O]}},{key:"runPopstate",value:function(t){var e=this,r=t.request;return this[E]=Promise.all([this.getParentPopstatePromise({request:r}),this.getPopstatePromise({request:r})]).then((function(t){var n=d(t,2),o=(n[0],n[1]);if(e[S])return Promise.resolve(e.popstate({request:r,response:o,popstateResult:o,config:e.config}))})).catch((function(t){return e.runCatch({request:r,error:t})})),this[j]=Promise.all([this[E]].concat(m(this.nodes.map((function(t){return t.runPopstate({request:r})}))))),this[j]}},{key:"runDestroy",value:function(t){var e=t.request;if(this[S]){this.info("destroy"),this[S]=!1;var r=this.nodes.map((function(t){return t.runDestroy({request:e})}));return Promise.all([this.destroy({request:e,config:this.config})].concat(m(r)))}return Promise.resolve()}},{key:"runCatch",value:function(t){var e=t.request,r=t.error;return this.catch({request:e,error:r})}},{key:"catch",value:function(t){var e=t.request,r=t.error;if(this[S]){switch(this[S]=!1,r.constructor){case C:!1!==this.onPropagateError({request:e,error:r})&&this.nodes.forEach((function(t){return t.catch({request:e,error:r,stack:r.stack})}));break;case D:!1!==this.onBubbleError({request:e,error:r})&&this.parent.catch({request:e,error:r,stack:r.stack});break;case Error:this.onCatch({request:e,error:r,stack:r.stack})}throw x("".concat(this.constructor.name,"::error"),"#e6194b",{self:this,error:r,stack:r.stack}),r}}},{key:"onCatch",value:function(t){var e=t.request,r=t.error;this.log("onCatch",{request:e,error:r})}},{key:"onPropagateError",value:function(t){t.request,t.error}},{key:"onBubbleError",value:function(t){t.request,t.error}},{key:"log",value:function(t,e){var r=this.constructor.plugin;!vt.debug||void 0!==r&&!0!==r.debug||(r=r||{debug:!0,color:"#777"},console.log("%c--\x3e ".concat(this.constructor.name,"::").concat(t),"color: ".concat(r.color||"#000"),e,this))}},{key:"info",value:function(t){var e=this.constructor.plugin;if(vt.debug&&(void 0===e||!0===e.debug)){var r;e=e||{debug:!0,color:"#777"},console.groupCollapsed("%c%s %c%s","color:#aaa",A(10,this[Symbol.toStringTag]),"color: ".concat(e.color),"".concat(this.constructor.name,"::").concat(t));for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];(r=console).log.apply(r,[this].concat(o)),console.groupEnd()}}},{key:"setState",value:function(t,e){return vt.setState(t,e),vt.getState(t)}},{key:"subscribe",value:function(t,e){return vt.subscribe(this,t,e),!0}},{key:"unsubscribe",value:function(t,e){return vt.unsubscribe(this,t,e),!0}},{key:"loaderStart",value:function(){}},{key:"loaderStop",value:function(){}},{key:"parent",get:function(){return T.get(this)},set:function(t){return T.set(this,t)}}]),t}();var L=new RegExp("%[a-f0-9]{2}","gi"),U=new RegExp("(%[a-f0-9]{2})+","gi");function z(t,e){try{return decodeURIComponent(t.join(""))}catch(t){}if(1===t.length)return t;e=e||1;var r=t.slice(0,e),n=t.slice(e);return Array.prototype.concat.call([],z(r),z(n))}function M(t){try{return decodeURIComponent(t)}catch(n){for(var e=t.match(L),r=1;r<e.length;r++)e=(t=z(e,r).join("")).match(L);return t}}var $,B=function(t){if("string"!=typeof t)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch(e){return function(t){for(var e={"%FE%FF":"��","%FF%FE":"��"},r=U.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch(t){var n=M(r[0]);n!==r[0]&&(e[r[0]]=n)}r=U.exec(t)}e["%C2"]="�";for(var o=Object.keys(e),i=0;i<o.length;i++){var u=o[i];t=t.replace(new RegExp(u,"g"),e[u])}return t}(t)}},H=(t,e)=>{if("string"!=typeof t||"string"!=typeof e)throw new TypeError("Expected the arguments to be of type `string`");if(""===e)return[t];const r=t.indexOf(e);return-1===r?[t]:[t.slice(0,r),t.slice(r+e.length)]},W=(function(t,e){function r(t){if("string"!=typeof t||1!==t.length)throw new TypeError("arrayFormatSeparator must be single character string")}function n(t,e){return e.encode?e.strict?encodeURIComponent(t).replace(/[!'()*]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`):encodeURIComponent(t):t}function o(t,e){return e.decode?B(t):t}function i(t){const e=t.indexOf("#");return-1!==e&&(t=t.slice(0,e)),t}function u(t){const e=(t=i(t)).indexOf("?");return-1===e?"":t.slice(e+1)}function s(t,e){return e.parseNumbers&&!Number.isNaN(Number(t))&&"string"==typeof t&&""!==t.trim()?t=Number(t):!e.parseBooleans||null===t||"true"!==t.toLowerCase()&&"false"!==t.toLowerCase()||(t="true"===t.toLowerCase()),t}function a(t,e){r((e=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},e)).arrayFormatSeparator);const n=function(t){let e;switch(t.arrayFormat){case"index":return(t,r,n)=>{e=/\[(\d*)\]$/.exec(t),t=t.replace(/\[\d*\]$/,""),e?(void 0===n[t]&&(n[t]={}),n[t][e[1]]=r):n[t]=r};case"bracket":return(t,r,n)=>{e=/(\[\])$/.exec(t),t=t.replace(/\[\]$/,""),e?void 0!==n[t]?n[t]=[].concat(n[t],r):n[t]=[r]:n[t]=r};case"comma":case"separator":return(e,r,n)=>{const i="string"==typeof r&&r.split("").indexOf(t.arrayFormatSeparator)>-1?r.split(t.arrayFormatSeparator).map(e=>o(e,t)):null===r?r:o(r,t);n[e]=i};default:return(t,e,r)=>{void 0!==r[t]?r[t]=[].concat(r[t],e):r[t]=e}}}(e),i=Object.create(null);if("string"!=typeof t)return i;if(!(t=t.trim().replace(/^[?#&]/,"")))return i;for(const r of t.split("&")){let[t,u]=H(e.decode?r.replace(/\+/g," "):r,"=");u=void 0===u?null:"comma"===e.arrayFormat?u:o(u,e),n(o(t,e),u,i)}for(const t of Object.keys(i)){const r=i[t];if("object"==typeof r&&null!==r)for(const t of Object.keys(r))r[t]=s(r[t],e);else i[t]=s(r,e)}return!1===e.sort?i:(!0===e.sort?Object.keys(i).sort():Object.keys(i).sort(e.sort)).reduce((t,e)=>{const r=i[e];return Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?t[e]=function t(e){return Array.isArray(e)?e.sort():"object"==typeof e?t(Object.keys(e)).sort((t,e)=>Number(t)-Number(e)).map(t=>e[t]):e}(r):t[e]=r,t},Object.create(null))}e.extract=u,e.parse=a,e.stringify=(t,e)=>{if(!t)return"";r((e=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},e)).arrayFormatSeparator);const o=function(t){switch(t.arrayFormat){case"index":return e=>(r,o)=>{const i=r.length;return void 0===o||t.skipNull&&null===o?r:null===o?[...r,[n(e,t),"[",i,"]"].join("")]:[...r,[n(e,t),"[",n(i,t),"]=",n(o,t)].join("")]};case"bracket":return e=>(r,o)=>void 0===o||t.skipNull&&null===o?r:null===o?[...r,[n(e,t),"[]"].join("")]:[...r,[n(e,t),"[]=",n(o,t)].join("")];case"comma":case"separator":return e=>(r,o)=>null==o||0===o.length?r:0===r.length?[[n(e,t),"=",n(o,t)].join("")]:[[r,n(o,t)].join(t.arrayFormatSeparator)];default:return e=>(r,o)=>void 0===o||t.skipNull&&null===o?r:null===o?[...r,n(e,t)]:[...r,[n(e,t),"=",n(o,t)].join("")]}}(e),i=Object.assign({},t);if(e.skipNull)for(const t of Object.keys(i))void 0!==i[t]&&null!==i[t]||delete i[t];const u=Object.keys(i);return!1!==e.sort&&u.sort(e.sort),u.map(r=>{const i=t[r];return void 0===i?"":null===i?n(r,e):Array.isArray(i)?i.reduce(o(r),[]).join("&"):n(r,e)+"="+n(i,e)}).filter(t=>t.length>0).join("&")},e.parseUrl=(t,e)=>({url:i(t).split("?")[0]||"",query:a(u(t),e)}),e.stringifyUrl=(t,r)=>{const n=i(t.url).split("?")[0]||"",o=e.extract(t.url),u=e.parse(o),s=function(t){let e="";const r=t.indexOf("#");return-1!==r&&(e=t.slice(r)),e}(t.url),a=Object.assign(u,t.query);let c=e.stringify(a,r);return c&&(c=`?${c}`),`${n}${c}${s}`}}($={exports:{}},$.exports),$.exports);W.extract,W.parse,W.stringify,W.parseUrl,W.stringifyUrl;function Z(t,e){var r=t.indexOf("?");if(r>-1){var n=t.slice(0,r),o=W.parse(t.slice(r)),i=W.stringify(u({},o,{},e),{encode:!1,arrayFormat:"brackets"});return console.log({urlSlug:n,urlParams:o,newQueryParams:i}),n+(i.length?"?"+i:"")}return void 0!==e&&Object.getOwnPropertyNames(e).length?t+"?"+W.stringify(e,{encode:!1,arrayFormat:"brackets"}):t}function Q(t){vt.debug&&("development"===vt.env?console.group("%c%s %c%s %c%s %c%s","color:#aaa","route","color:purple",t,"color:#111",location.pathname,"color:#007bff;font-weight:normal",vt.request.type):"staging"===vt.env&&console.groupCollapsed("%c%s %c%s %c%s %c%s","color:#aaa","route","color:purple",t,"color:#111",location.pathname,"color:#007bff;font-weight:normal",vt.request.type))}function G(t){var e=[],r={},n=!(t instanceof RegExp)&&t.replace(/\//g,"\\/").replace(/\.?\*/,".*").replace(/\{([^:]+)\:?([^}]*)(\?)?\}/g,(function(t,n,o,i){switch(e.push(n),r[n]={type:o},o){case"char":case"alpha":case"string":return r[n].regex="([a-zA-Z-_%&]".concat(i?"*":"+",")");case"int":case"num":case"number":return r[n].regex="([0-9]".concat(i?"*":"+",")");default:return o?(r[n].type="regex",r[n].regex=o):(r[n].type="mixed",r[n].regex="([a-zA-Z0-9-_%&]".concat(i?"*":"+",")"))}}));return{params:r,string:n,index:e,regex:t instanceof RegExp?t:new RegExp(n)}}var J=null,K=function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.type,i=void 0===n?"http":n,u=r.uuid,s=void 0===u?0:u,a=r.url,c=void 0===a?location.pathname:a,l=r.params,f=r.scrollTop,h=void 0===f?0:f;e(this,t),o(this,"type","http"),o(this,"keywords",[]),o(this,"params",{}),o(this,"values",[]),o(this,"scrollTop",0),this.prev=J,this.type=i,this.uuid=s,this.pathname=c,this.scrollTop=h,this.params=W.parse(location.search.slice(location.search.indexOf("?")+1)),this.href=Z(c,l),J=this.pathname};function V(t,e=[]){return(...r)=>{return(n=[...e,...r]).length>=t.length?t(...n):V(t,n);var n}}const X=V((function(t,e,r){return Object.assign({},r,{[t]:e})}));function Y(t){return t<<0===t}const tt=V((function t(e,r,n){const o="string"==typeof e?e.split("."):e;if(0===o.length)return r;const i=o[0];if(o.length>1){const e="object"!=typeof n||null===n||!n.hasOwnProperty(i)?Y(parseInt(o[1],10))?[]:{}:n[i];r=t(Array.prototype.slice.call(o,1),r,e)}if(Y(parseInt(i,10))&&Array.isArray(n)){const t=n.slice();return t[i]=r,t}return X(i,r,n)}));function et(t){return function t(e,r){return 1===arguments.length?r=>t(e,r):function(t){return function(n){return t(e(n)).map(t=>r(t,n))}}}(function t(e,r){if(1===arguments.length)return r=>t(e,r);if(null==r)return;let n=r,o=0;const i="string"==typeof e?e.split("."):e;for(;o<i.length;){if(null==n)return;n=n[i[o]],o++}return n}(t),tt(t))}const rt=t=>({x:t,map:e=>rt(e(t))});function nt(t,e,r){return 1===arguments.length?(e,r)=>nt(t,e,r):2===arguments.length?r=>nt(t,e,r):t(t=>rt(e(t)))(r).x}const ot=t=>({x:t,map:e=>ot(t)});function it(t,e){return 1===arguments.length?e=>it(t,e):t(ot)(e).x}function ut(t){const e=typeof t;if(null===t)return"Null";if(void 0===t)return"Undefined";if("boolean"===e)return"Boolean";if("number"===e)return Number.isNaN(t)?"NaN":"Number";if("string"===e)return"String";if(Array.isArray(t))return"Array";if(t instanceof RegExp)return"RegExp";const r=t&&t.toString?t.toString():"";return["true","false"].includes(r)?"Boolean":Number.isNaN(Number(r))?r.startsWith("async")?"Async":"[object Promise]"===r?"Promise":"function"===e?"Function":t instanceof String?"String":"Object":"Number"}function st(t){const e=t.__proto__.toString();return["Error","TypeError"].includes(e)?[e,t.message]:[]}function at(t){return t.toDateString?[!0,t.getTime()]:[!1]}function ct(t){return t.constructor!==RegExp?[!1]:[!0,t.toString()]}var lt,ft=[],ht=0;lt=Symbol.toStringTag;var pt,yt=function(t){s(i,t);var r=v(i);function i(t){var n;e(this,i),o(p(n=r.call(this,{},t)),"debug",!0),o(p(n),"env","development"),o(p(n),"setScrollOnPopstate",!0),o(p(n),lt,"Magna"),n.nodes=[],n.__state={},n.__subscribers=new Map,n[S]=!0,n.request=new K({type:"http",uuid:ht,url:location.pathname}),ft.push(n.request),history.replaceState(u({},history.state,{},n.request,{scrollTop:document.body.scrollTop,index:ft.length,prev:location.pathname}),document.title);p(n);return n.__setActiveUrl(),window.addEventListener("popstate",(function(t){if(null===t.state)return t.preventDefault(),!1;var e=n.request=u({},t.state,{prev:ft[ft.length-1].pathname});return n.__setActiveUrl(),Q("popstate",p(n)),n.runDestroy({request:e}).then((function(t){return console.groupEnd(),Q("popstate",p(n)),n.runPopstate({request:e}).then((function(t){return console.groupEnd(),t})).then((function(t){return Q("init",p(n)),t})).then((function(t){return n.runInit({request:e})})).then((function(t){return console.groupEnd(),t})).then((function(t){return window.dataLayer&&window.dataLayer.push({event:"Pageview",url:location.href}),t}))}))})),n}return n(i,[{key:"getHistory",value:function(){return ft}},{key:"start",value:function(t){var e=t.debug,r=void 0!==e&&e,n=t.env,o=void 0===n?"development":n,i=t.setScrollOnPopstate,u=void 0===i||i;Q("start"),this.debug=r,this.env=o,this.setScrollOnPopstate=u,this.runInit({request:this.request}).then((function(t){return console.groupEnd(),t}))}},{key:"popstate",value:function(t){t.request;var e=t.response;return this.debug&&console.log("popstate",e),window.dataLayer&&window.dataLayer.push({event:"Pageview",url:location.href}),this.debug&&console.groupEnd(),Promise.resolve()}},{key:"pushState",value:function(t,e,r,n){var o=this;ht++,history.replaceState(u({},history.state,{scrollTop:document.body.scrollTop,index:ft.length}),document.title),this.request=new K(u({type:"popstate",uuid:ht,href:location.pathname,url:r,params:n,title:e},t));var i=W.stringify(n,{encode:!1,arrayFormat:"brackets"});return history.pushState(this.request,this.request.title,r+(i?"?"+i:"")),this.__setActiveUrl(),ft.push(this.request),Q("pushState"),this.runDestroy({request:this.request}).then((function(t){return console.groupEnd(),Q("popstate"),o.runPopstate({request:o.request}).then((function(t){return console.groupEnd(),t})).then((function(t){return Q("init"),t})).then((function(t){return o.runInit({request:o.request})})).then((function(t){return console.groupEnd(),t})).then((function(t){return window.dataLayer&&window.dataLayer.push({event:"Pageview",url:location.href}),t}))}))}},{key:"use",value:function(t){return this.nodes=[].concat(m(this.nodes),m(t)),this.initChildren(),this}},{key:"rerun",value:function(){var t=this;return this.destroy(this.request).then((function(e){t.request=new K(u({type:"manual"},t.request)),t.init(t.request)})),this}},{key:"__setActiveUrl",value:function(){var t=location.pathname.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");document.querySelectorAll(".link--active").forEach((function(t){return t.classList.remove("link--active")})),m(document.querySelectorAll("a[href]")).filter((function(e){var r=e.href.replace(location.origin,"");return new RegExp("^"+t+"$").test(r)})).forEach((function(t){return t.classList.add("link--active")}))}},{key:"getState",value:function(t){return u({},this.__state)}},{key:"setState",value:function(t,e){"string"==typeof t&&(t=t.split(".")),t=t||["global"];var r=this.__state,n=nt(et(t),e,this.__state);if(n===this.__state)throw new Error("Do not mutate the state, please return a new object for the state");this.__state=n;var o,i=function(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=b(t))){var e=0,r=function(){};return{s:r,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,o,i=!0,u=!1;return{s(){n=t[Symbol.iterator]()},n(){var t=n.next();return i=t.done,t},e(t){u=!0,o=t},f(){try{i||null==n.return||n.return()}finally{if(u)throw o}}}}(this.__subscribers);try{var u=function(){var t=d(o.value,2),e=t[0],i=t[1],u=et(e.split("."));(function t(e,r){if(1===arguments.length)return r=>t(e,r);const n=ut(e);if(n!==ut(r))return!1;if(["NaN","Undefined","Null"].includes(n))return!0;if(["Boolean","Number","String"].includes(n))return e.toString()===r.toString();if("Array"===n){const n=Array.from(e),o=Array.from(r);if(n.toString()!==o.toString())return!1;let i=!0;return n.forEach((e,r)=>{i&&(e===o[r]||t(e,o[r])||(i=!1))}),i}const o=ct(e),i=ct(r);if(o[0])return!!i[0]&&o[1]===i[1];if(i[0])return!1;const u=at(e),s=at(r);if(u[0])return!!s[0]&&u[1]===s[1];if(s[0])return!1;const a=st(e),c=st(r);if(a[0])return!!c[0]&&(a[0]===c[0]&&a[1]===c[1]);if("Object"===n){const n=Object.keys(e);if(n.length!==Object.keys(r).length)return!1;let o=!0;return n.forEach(n=>{if(o){const i=e[n],u=r[n];i===u||t(i,u)||(o=!1)}}),o}return!1})(it(u,r),it(u,n))||i.forEach((function(t){var e=t.instance,r=t.cb;e[S]&&nt(u,r,n)}))};for(i.s();!(o=i.n()).done;)u()}catch(t){i.e(t)}finally{i.f()}return this}},{key:"subscribe",value:function(t,e,r){e=e?Array.isArray(e)?e.join("."):e:"global";var n=[];this.__subscribers.has(e)&&(n=this.__subscribers.get(e)),n.some((function(e){return e.cb===r&&e.instance===t}))||n.push({instance:t,cb:r,state:{}}),this.__subscribers.set(e,n)}},{key:"unsubscribe",value:function(t,e,r){e=Array.isArray(e)?e.join("."):String(e);var n=this.__subscribers.get(e).filter((function(e){return e.instance!==t&&e.cb!==r}));return this.__subscribers.set(e,n),!0}},{key:"trigger",value:function(t){var e=this;this.__subscribers.has(t)&&this.__subscribers.get(t).forEach((function(r){var n=r.cb,o=r.instance;o[S]&&(n(e.getState()),window.dispatchEvent(new CustomEvent(t,{detail:{state:e.getState(),instance:o}})))}))}}]),i}(F),vt=new yt;pt=Symbol.toStringTag;var gt,dt=function(t){s(i,t);var r=v(i);function i(t){var n,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e(this,i),o(p(n=r.call(this,{},u)),pt,"Import"),n.__promise=null,n.importer=t,n}return n(i,[{key:"initChildren",value:function(){var t=this;this.nodes.forEach((function(e){return e.parent=t}))}},{key:"initPromise",value:function(t){var e=t.request;return this.__promise=this.__promise||this.importer({request:e})}},{key:"popstatePromise",value:function(t){var e=t.request;return this.__promise=this.__promise||this.importer({request:e})}},{key:"runInit",value:function(t){var e=this,r=t.request;return g(a(i.prototype),"runInit",this).call(this,{request:r}).then((function(t){return e[S]&&e.__promise&&e.__promise.then((function(t){return t.default.runInit({request:r})}))}))}},{key:"runPopstate",value:function(t){var e=this,r=t.request;return g(a(i.prototype),"runPopstate",this).call(this,{request:r}).then((function(t){return e[S]&&e.__promise&&e.__promise.then((function(t){return t.default.runPopstate({request:r})}))}))}},{key:"runDestroy",value:function(t){var e=this,r=t.request;return g(a(i.prototype),"runDestroy",this).call(this,{request:r}).then((function(t){return e.__promise&&e.__promise.then((function(t){return t.default.runDestroy({request:r})}))}))}},{key:"init",value:function(t){t.request;return this.url}}]),i}(F);gt=Symbol.toStringTag;var mt,bt=function(t){s(i,t);var r=v(i);function i(t,n){var u,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return e(this,i),o(p(u=r.call(this,n,s)),gt,"Lazy"),u.__promise=null,u.importer=t,u.instance=null,u}return n(i,[{key:"initChildren",value:function(){}},{key:"initPromise",value:function(t){var e=t.request;return this.__promise=this.__promise||this.importer({request:e})}},{key:"popstatePromise",value:function(t){var e=t.request;return this.__promise=this.__promise||this.importer({request:e})}},{key:"runInit",value:function(t){var e=this,r=t.request;return g(a(i.prototype),"runInit",this).call(this,{request:r}).then((function(t){return e[S]&&e.__promise&&e.__promise.then((function(t){return e.instance=new t.default(e.config),e.instance.runInit({request:r}),e.instance}))}))}},{key:"runPopstate",value:function(t){var e=this,r=t.request;return g(a(i.prototype),"runPopstate",this).call(this,{request:r}).then((function(t){return e[S]&&e.__promise&&e.__promise.then((function(t){return e.instance.runPopstate({request:r})}))}))}},{key:"runDestroy",value:function(t){var e=this,r=t.request;return g(a(i.prototype),"runDestroy",this).call(this,{request:r}).then((function(t){return e.__promise&&e.__promise.then((function(t){return e.instance.runDestroy({request:r})}))}))}},{key:"init",value:function(t){t.request;return this.url}}]),i}(F);mt=Symbol.toStringTag;var qt,wt=function(t){s(i,t);var r=v(i);function i(t){var n;return e(this,i),o(p(n=r.call(this,{},t)),mt,"Module"),n}return n(i,[{key:"init",value:function(t){return t.request.url}}]),i}(F);qt=Symbol.toStringTag;var kt,_t=function(t){s(i,t);var r=v(i);function i(t){var n;return e(this,i),o(p(n=r.call(this,t)),qt,"Plugin"),n}return n(i,[{key:"init",value:function(t){return t.request.url}}]),i}(F);kt=Symbol.toStringTag;var St,Pt=function(t){s(i,t);var r=v(i);function i(){var t;e(this,i);for(var n=arguments.length,u=new Array(n),s=0;s<n;s++)u[s]=arguments[s];return o(p(t=r.call.apply(r,[this].concat(u))),kt,"Predicate"),t}return n(i,[{key:"shouldInitialize",value:function(t){var e=t.request;return!this.parent||this.parent[S]&&this.predicate({request:e})}},{key:"predicate",value:function(t){t.request;throw new Error("Predicate class must contain a predicate method that returns a boolean")}}]),i}(F);St=Symbol.toStringTag;var Ot,Et=function(t){s(i,t);var r=v(i);function i(t){var n,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e(this,i),o(p(n=r.call(this,{url:t},u)),St,"Route"),n}return n(i,[{key:"predicate",value:function(t){t.request;return this.parser.regex.test(location.pathname)}},{key:"processHref",value:function(t){var e=t.href,r=t.regex,n=(t.params,t.keywords,t.index),i=e.match(r);return i?n.reduce((function(t,e,r){return u({},t,o({},e,i[r+1]))}),{}):{}}},{key:"createNewRequest",value:function(t){var e=t.request,r=G(this.config.url),n=this.processHref(u({href:location.pathname},r)),o=W.parse(location.search.slice(1),{plainObjects:!0});return this.parser=r,this.params=n,this.search=o,u({},e,{params:u({},e.params&&e.params,{},n),search:o})}},{key:"runInit",value:function(t){var e=t.request,r=this.createNewRequest({request:e});return g(a(i.prototype),"runInit",this).call(this,{request:r})}},{key:"runPopstate",value:function(t){var e=t.request,r=this.createNewRequest({request:e});return g(a(i.prototype),"runPopstate",this).call(this,{request:r})}},{key:"info",value:function(t){var e=this.constructor.plugin;if(vt.debug&&(void 0===e||!0===e.debug)){var r;e=e||{debug:!0,color:"#777"},console.groupCollapsed("%c%s %c%s","color:#aaa",A(10,this[Symbol.toStringTag]),"color: ".concat(e.color),"".concat(this.constructor.name,"::").concat(t),this.config.url);for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];(r=console).log.apply(r,[this].concat(o)),console.groupEnd()}}}]),i}(Pt);o(Et,"plugin",{color:"#A82DFF",debug:!0}),Ot=Symbol.toStringTag;var jt,xt=function(t){s(i,t);var r=v(i);function i(t){var n;return e(this,i),o(p(n=r.call(this,t)),Ot,"Singleton"),o(p(n),"initialized",!1),n}return n(i,[{key:"shouldInitialize",value:function(t){t.request;return!this.initialized&&(this.initialized=!0)}},{key:"init",value:function(t){return t.request.url}}]),i}(F);jt=Symbol.toStringTag;var It=function(t){s(i,t);var r=v(i);function i(t,n){var u;return e(this,i),o(p(u=r.call(this,{selector:t},n)),jt,"ElementExists"),u}return n(i,[{key:"predicate",value:function(t){t.request;return!!document.querySelector(this.config.selector)}}]),i}(Pt),At=function(t){s(o,t);var r=v(o);function o(t,n,i){var u;return e(this,o),u=r.call(this,{event:t,target:n},i),Nt.set(p(u),{writable:!0,value:null}),Tt.set(p(u),{writable:!0,value:null}),u}return n(o,[{key:"runInit",value:function(t){var e=this,r=t.request;this[S]=!0,k(this,Nt,document.querySelector(this.config.target)),w(this,Nt).addEventListener(this.config.event,k(this,Tt,(function(t){w(e,Nt).removeEventListener(e.config.event,w(e,Tt)),g(a(o.prototype),"runInit",e).call(e,{request:r})})))}},{key:"runDestroy",value:function(t){var e=t.request;return w(this,Nt).removeEventListener(this.config.event,w(this,Tt)),g(a(o.prototype),"runDestroy",this).call(this,{request:e})}}]),o}(F),Nt=new WeakMap,Tt=new WeakMap,Rt=function(t){s(o,t);var r=v(o);function o(t,n){var i;return e(this,o),(i=r.call(this,t,n)).nodes=n,i.pattern=t,i.regex=regexify(t),i}return n(o,[{key:"initNodes",value:function(t){var e=t.request;return this.regex.test(e.prev)!==this.regex.test(e.pathname)?g(a(o.prototype),"initNodes",this).call(this,{request:e}):Promise.resolve("OnlyOnRouteChange:same-url")}},{key:"initDestroy",value:function(t){var e=t.request;return this.regex.test(e.prev)!==this.regex.test(e.pathname)?g(a(o.prototype),"initDestroy",this).call(this,{request:e}):Promise.resolve("OnlyOnRouteChange:same-url")}}]),o}(F),Ct=function(t){s(o,t);var r=v(o);function o(t,n){return e(this,o),r.call(this,{event:t},n)}return n(o,[{key:"runInit",value:function(t){var e=this,r=t.request;this[S]=!0,this.subscribe(this.config.event,this.__onEvent=function(t){e.unsubscribe(e.config.event,e.__onEvent),g(a(o.prototype),"runInit",e).call(e,{request:r})})}},{key:"runDestroy",value:function(t){var e=t.request;this.unsubscribe(this.config.event,this.__onEvent),g(a(o.prototype),"runDestroy",this).call(this,{request:e})}}]),o}(F);return t.ElementExists=It,t.Import=dt,t.Lazy=bt,t.Magna=yt,t.Module=wt,t.Node=F,t.One=At,t.OnlyOnRouteChange=Rt,t.Plugin=_t,t.Predicate=Pt,t.Route=Et,t.Singleton=xt,t.Subscribe=Ct,t.combineUrlParams=Z,t.debounce=function(t,e){var r=null;return function(n){var o=this,i=arguments;clearTimeout(r),r=setTimeout((function(){e.apply(o,i)}),t)}},t.default=vt,t.elementExists=function(t,e){return new It(t,e)},t.log=x,t.logAction=function(t){vt.debug&&("development"===vt.env?console.group("%c%s %c%s","color:#aaa","action","color:teal",t):"staging"===vt.env&&console.groupCollapsed("%c%s %c%s","color:#aaa","action","color:teal",t))},t.logRoute=Q,t.mergeDeepRight=I,t.one=function(t,e,r){return new At(t,e,r)},t.onlyOnRouteChange=function(t,e){return new Rt(t,e)},t.pad=A,t.prettify=function(t){return t.replace("%20"," ").replace(/([^a-z0-9]+)/gim," ")},t.radioClass=function(t,e){return function(r){e=document.querySelector(e),t.forEach((function(t){return e.classList.remove(t)})),e.classList.add(r)}},t.regexify=G,t.route=function(t,e){return new Et(t,e)},t.subscribe=function(t,e,r){return new Ct(t,e,r)},t.tap=function(t){return function(e){return t.call(this,e),e}},t.trace=function(t){return function(e){return console.log(t,e),e}},t.uglify=function(t){return t.toLowerCase().replace(/([^a-z0-9]+)/gim,"-")},t}({});
